{% extends "base.html" %}
{% block content %}
<div class="shell">
  <header class="topbar">
    <div class="brand">Encrypted Cloud</div>
    <div class="actions">
      <button id="lock-btn" class="btn icon-btn ghost" type="button" aria-label="Lock Vault" title="Lock Vault">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
      </button>

      <div class="settings-wrapper">
        <button id="settings-btn" class="btn icon-btn ghost" type="button" aria-label="Settings" title="Settings">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path
              d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
            </path>
          </svg>
        </button>
        <div id="settings-popup" class="settings-popup" hidden>
          <div class="settings-header">Vault Settings</div>
          <div class="settings-body">
            <div class="field">
              <label for="theme-select">Theme</label>
              <select id="theme-select">
                <option value="">Default (Dark)</option>
                <option value="light">Light</option>
                <option value="ultra-dark">Ultra Dark</option>
                <option value="high-contrast">High Contrast</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="vault">
    <section class="panel upload">
      <h2>Upload</h2>
      <p class="sub">Drag & drop a file. It will be encrypted before storage.</p>
      <div id="drop-zone" class="drop-zone">
        <div class="drop-inner">
          <div class="drop-title">Drop files here</div>
          <div class="drop-sub">or click to browse</div>
        </div>
        <input id="file-input" type="file" />
      </div>
      <div id="upload-status" class="hint" hidden></div>
    </section>

    <section class="panel files">
      <div class="files-header">
        <h2>Your Files</h2>
        <span id="file-count" class="meta">Loading...</span>
      </div>
      <div class="storage">
        <div class="storage-labels">
          <span>Storage Used</span>
          <span>{{ used_bytes|filesizeformat(binary=True) }} / {{ total_bytes|filesizeformat(binary=True) }}</span>
        </div>
        <div class="storage-track">
          <div class="storage-fill" style="width: {{ percent }}%"></div>
        </div>
      </div>
      <div class="filters">
        <div class="search">
          <input id="file-search" type="text" placeholder="Search files..." />
        </div>
        <div class="filter-group">
          <select id="date-filter">
            <option value="all">All dates</option>
            <option value="24h">Last 24h</option>
            <option value="7d">Last 7 days</option>
            <option value="30d">Last 30 days</option>
          </select>
          <select id="size-filter">
            <option value="all">All sizes</option>
            <option value="lt1">Under 1 MB</option>
            <option value="1to10">1–10 MB</option>
            <option value="10to100">10–100 MB</option>
            <option value="gt100">Over 100 MB</option>
          </select>
          <select id="sort-by">
            <option value="newest">Newest first</option>
            <option value="oldest">Oldest first</option>
            <option value="largest">Largest first</option>
            <option value="smallest">Smallest first</option>
          </select>
        </div>
      </div>
      <div id="file-list" class="file-list">
        <div id="loading-indicator" class="empty">
          <div class="spinner"></div>
          <p>Decrypting vault...</p>
        </div>
      </div>
      <div id="no-results" class="empty" hidden>No files match your filters.</div>
      <div id="empty-state" class="empty" hidden>No files yet. Upload your first file above.</div>

      <template id="file-card-template">
        <div class="file-card appearing">
          <div class="file-main">
            <div class="file-preview">
            </div>
            <div class="file-details">
              <div class="file-name"></div>
              <div class="file-meta"></div>
              <div class="file-meta uploaded-at"></div>
            </div>
          </div>
          <div class="file-actions">
            <button class="btn small rename-btn" type="button">Edit</button>
            <a class="btn small ghost download-btn">Download</a>
            <button class="btn small ghost danger delete-btn" type="button">Delete</button>
          </div>
        </div>
      </template>
    </section>
  </main>

  <div id="delete-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-close="true"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="delete-title">
      <h3 id="delete-title">Delete File</h3>
      <p id="delete-message" class="modal-text">Are you sure you want to delete this file?</p>
      <div class="modal-actions">
        <button id="cancel-delete" class="btn ghost" type="button">Cancel</button>
        <button id="confirm-delete" class="btn danger" type="button">Delete</button>
      </div>
    </div>
  </div>
  <div id="rename-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-close="true"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="rename-title">
      <h3 id="rename-title">Rename File</h3>
      <div class="field">
        <label for="rename-input">New Name</label>
        <input id="rename-input" type="text" class="input" placeholder="Enter new name" />
        <p class="hint">File extension will be preserved.</p>
      </div>
      <div class="modal-actions">
        <button id="cancel-rename" class="btn ghost" type="button">Cancel</button>
        <button id="confirm-rename" class="btn primary" type="button">Save</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}